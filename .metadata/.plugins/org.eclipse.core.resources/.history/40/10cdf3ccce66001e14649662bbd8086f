package DAOS;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import java.util.Date;

import com.toedter.calendar.JDateChooser;

import conexion.startConnectionserver;

public class reservasDAO {
	private int idreservation;

	public void guardarreservas(java.util.Date date, java.util.Date date2, String c, String d) throws SQLException {
		try (Connection con = new startConnectionserver().getConnectionserver();
				// statement para guardar reserva
				PreparedStatement statement = con.prepareStatement(
						"INSERT INTO reservations (DATE_OF_ENTRY, DEPARTURE_DATE, Gvalue, payment) VALUES (?, ?, ?, ?);")) {

			SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
			// guardar reserva
			statement.setDate(1, new java.sql.Date(date.getTime()));
			statement.setDate(2, new java.sql.Date(date2.getTime()));
			statement.setString(3, c);
			statement.setString(4, d);
			statement.execute();

		} catch (SQLException e) {
			e.printStackTrace(); // Manejar la excepción adecuadamente
		}

	}

	public int GetIdreservation(JDateChooser jDateChooser, JDateChooser jDateChooser2, String c, String d) throws SQLException {
		try (Connection con = new startConnectionserver().getConnectionserver();
				// statement para obtener id
				PreparedStatement statement2 = con.prepareStatement(
						"SELECT id FROM reservations WHERE DATE_OF_ENTRY = ? AND DEPARTURE_DATE = ? AND Gvalue = ? AND payment = ? ")) {

			// conseguir Id de reserva guardada
			statement2.setDate(1, new java.sql.Date(jDateChooser.getTime()));
			statement2.setDate(2, new java.sql.Date(jDateChooser2.getTime()));
			statement2.setString(3, c);
			statement2.setString(4, d);

			statement2.execute();
			ResultSet resultSet = statement2.executeQuery();
			if (resultSet.next()) {
				idreservation = resultSet.getInt("id");
				System.out.println((resultSet.getInt("id")));
			}

		} catch (SQLException e) {
			e.printStackTrace(); // Manejar la excepción adecuadamente
		}
		return idreservation;
	}
}