package DAOS;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.SimpleDateFormat;
import java.util.Date;

import conexion.startConnectionserver;

public class reservasDAO {

	private int idreservation;

	public int guardarreservas(java.util.Date date, java.util.Date date2, String c, String d) throws SQLException {
	    try (Connection con = new startConnectionserver().getConnectionserver();
	            // statement para guardar reserva
	            PreparedStatement statement = con.prepareStatement(
	                    "INSERT INTO reservations (DATE_OF_ENTRY, DEPARTURE_DATE, Gvalue, payment) VALUES (?, ?, ?, ?);",
	                    Statement.RETURN_GENERATED_KEYS)) {

	        SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
	        // guardar reserva
	        statement.setDate(1, new java.sql.Date(date.getTime()));
	        statement.setDate(2, new java.sql.Date(date2.getTime()));
	        statement.setString(3, c);
	        statement.setString(4, d);

	        int filasAfectadas = statement.executeUpdate();

	        if (filasAfectadas > 0) {
	            ResultSet generatedKeys = statement.getGeneratedKeys();
	            if (generatedKeys.next()) {
	                int  idInsertado = generatedKeys.getInt(1);
	                
	                System.out.println("ID de la fila insertada: " + idInsertado);
	                return idInsertado;
	            }
	        }

	    } catch (SQLException e) {
	        e.printStackTrace(); 
	    }
	    return 0;
	}


}